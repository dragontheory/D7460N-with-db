<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="D7460N" />
    <meta name="description" content="Could tell you, but then I'd have to... well, you know." />
    <meta name="color-scheme" content="dark light" />
    <title>D7460N</title>
    <link type="image/svg+xml" rel="icon" href="assets/images/logo.svg" />
    <link type="text/css" rel="stylesheet" href="assets/css/styles.css" />
    <style type="text/acss">

	/***
	 * Call data on body init.
	**/
	body:init {
		$totalVisible: 0;
		$totalNonVisible: 0;
		$liCo: 0;
		$startingLiCo: 0;
		app-panel:nth-of-type(3) panel-list list-item {
			$liCo++;
		}
		app-panel:nth-of-type(3) panel-list {
			trigger: countRows;
		}
		app-panel:nth-of-type(3) panel-list {
/*			ajax: "https://my-json-server.typicode.com/dragontheory/D7460N-data/names/" get json await;*/
			ajax: "https://activecss.org/get-supes.php" get json await;
			/* ajax: "https://dragontheory.com/json/D7460N.json" get json await; */
			/* Pre-fetch JSON on mouseover to make the user think it's really quick. 
			app-panel:nth-of-type(3) panel-list list-item:not-if-var($currentUserID "{@data-id}"):mouseover {
			ajax-pre-get: "https://my-json-server.typicode.com/dragontheory/D7460N-data/names/{@data-id}" get json;
			}*/
			console-log: "getting here";
			trigger: setup;
			$startingLiCo: $liCo;
			@each $item in {JSON}.data {
				$liCo++;
				/* Pipe a plain ACSS HTML component. Pipe here would mean import component details, fill in the variables, and output to the page. */
				render-before-end: "{|rowContent}";
			}

			trigger: countRows;
		}
	}


	/***
	 *	Plain ACSS HTML component. Using a component for the HTML means that you don't have to escape the double quotes, so it's cleaner.
 	 *	Note - rel="noopener" for untrusted link prevents a JS attack from the opening website.
 	**/

	/* ID, alias, real name, current status, current org/affiliation, current location, power rating/rank? */
/*
				<list-cell>{$item.id}</list-cell>
				<list-cell>{$item.name}</list-cell>
				<list-cell>{$item.username}</list-cell>
				<list-cell><a href="https://{$item.website}" target="_new" rel="noopener">{$item.website}</a></list-cell>
				<list-cell><a href="mailto:{$item.email}" target="_new" rel="noopener">{$item.email}</a></list-cell>
*/
	@component rowContent {
		html {
			<list-item data-co="{$liCo}" data-id="{$item.id}">
				<list-cell><input type="checkbox" id="" name="table-row" value="" /></list-cell>
				<list-cell>{$item.id}</list-cell>
				<list-cell>{$item.name}</list-cell>
				<list-cell>{$item.biography.fullName}</list-cell>
				<list-cell>{$item.biography.alignment}</list-cell>
				<list-cell>{$item.connections.groupAffiliation}</list-cell>
				<list-cell>{$item.powerstats.power}</list-cell>
			</list-item>
		}
	}


	/***
	 * This is the custom event - it gets used twice - once when the page is drawn and again when the button is clicked.
	**/
	app-panel:nth-of-type(3) panel-list:countRows {
		@for $n from $startingLiCo + 1 to $liCo {
			@if completely-visible(list-item[data-co="{$n}"]) {
				$totalVisible++;
			} @else {
				$totalNonVisible++;
			}
		}
		#visibleCount {
			@if $totalVisible < 10 {
				render: "0{$totalVisible}";
			} @else {
				render: "{$totalVisible}";
			}
		}
		#nonVisibleCount {
			@if $totalNonVisible < 10 {
				render: "0{$totalNonVisible}";
			} @else {
				render: "{$totalNonVisible}";
			}
		}
	}


	/***
	 * Call data to app-panel:nth-of-type(4).
	**/
	app-panel:nth-of-type(3) panel-list list-item:not-if-var($currentUserID "{@data-id}"):click {
		$currentUserID: "{@data-id}";
/*		ajax: "https://my-json-server.typicode.com/dragontheory/D7460N-data/names/{@data-id}" get json cache await;*/
		ajax: "https://activecss.org/get-supe.php?id={@data-id}" get json cache await;
		$item: {JSON}.data[0];
		app-panel:nth-of-type(4) panel-list {
			/* Pipe a plain ACSS HTML component. Pipe here would mean import component details, fill in the variables, and output to the page. */
			render: "{|asideContent}";
		}
		run: {=
			const dragonEvent = new Event('rowclicked', { bubbles: true });
			o.obj.dispatchEvent(dragonEvent);
		=};
	}


	/***
	 *	Plain ACSS HTML component. Using a component for the HTML means that you don't have to escape the double quotes, so it's cleaner.
	 *	Note - rel="noopener" for untrusted link prevents a JS attack from the opening website.
	**/
/*
			<list-item><list-cell>ID</list-cell><list-cell>{$item.id}</list-cell></list-item>
			<list-item><list-cell>name</list-cell><list-cell>{$item.name}</list-cell></list-item>
			<list-item><list-cell>username</list-cell><list-cell>{$item.username}</list-cell></list-item>
			<list-item><list-cell>website</list-cell><list-cell><a href="https://{$item.website}" target="_new" rel="noopener">{$item.website}</a></list-cell></list-item>
			<list-item><list-cell>email</list-cell><list-cell><a href="mailto:{$item.email}" target="_new" rel="noopener">{$item.email}</a></list-cell></list-item>
*/
	@component asideContent {
		html {
			<list-item><list-cell>ID</list-cell><list-cell>{$item.id}</list-cell></list-item>
			<list-item><list-cell>alias</list-cell><list-cell>{$item.name}</list-cell></list-item>
			<list-item><list-cell>name</list-cell><list-cell>{$item.biography.fullName}</list-cell></list-item>
			<list-item><list-cell>alignment</list-cell><list-cell>{$item.biography.alignment}</list-cell></list-item>
			<list-item><list-cell>affiliation</list-cell><list-cell>{$item.connections.groupAffiliation}</list-cell></list-item>
			<list-item><list-cell>power</list-cell><list-cell>{$item.powerstats.power}</list-cell></list-item>

			<input id="userID" type="hidden" value="{$item.id}">
		}
	}


	/***
	 * Show panels when there are children of panel-list.
	**/
	app-panel:nth-of-type(2) panel-list:not-if-empty:observe {
		body {
			add-class: .nav;
		}
		console-log: "Show NAV";
	}


	/***
	 * Show panels when there are children of panel-list.
	**/
	app-panel:nth-of-type(2) panel-list:not-if-empty:observe {
		body {
			add-class: .nav;
		}
		console-log: "Show NAV";
	}


	/***
	 * Show panels when there are children of panel-list.
	**/
	app-panel:nth-of-type(3) panel-list:not-if-empty:observe {
		body {
			add-class: main;
		}
		console-log: "Show MAIN";
	}


	/***
	 * Hide panel when there are NO children of panel-list.
	**/
	app-panel:nth-of-type(3) panel-list:if-empty:observe {
		body {
			remove-class: main;
		}
		app-panel:nth-of-type(3) {
			remove-attribute: style;
		}
		console-log: "Hide MAIN";
	}


	/***
	 * Show panels when there are children of panel-list.
	**/
	app-panel:nth-of-type(4) panel-list:not-if-empty:observe {
		body {
			add-class: aside;
		}
		console-log: "Show ASIDE";
	}


	/***
	 *
	*/
	app-panel:nth-of-type(4) panel-list #userID:draw { {
		app-panel:nth-of-type(3) panel-list list-item[data-id="{$currentUserID}"] {
			take-class: .active scope(app-panel:nth-of-type(3) panel-list);
			console-log: "Take MAIN .active";
		}
	}


	/* app-panel:nth-of-type(4) panel-list:if-empty:observe{
		app-panel:nth-of-type(3) panel-list list-item.active {
			remove-class: .active;
			console-log: "Remove LIST-ITEM .active";
		}
	} */


	/***
	 * Hide panel when there are NO children of panel-list.
	**/
	app-panel:nth-of-type(4) panel-list:if-empty:observe {
		$currentUserID: null;
		body {
			remove-class: aside;
		}
		console-log: "Hide ASIDE";
		app-panel:nth-of-type(3) panel-list list-item.active {
			remove-class: .active scope(app-panel:nth-of-type(3) panel-list);
			console-log: "Remove MAIN LIST-ITEM .active";
		}
		app-panel:nth-of-type(3) {
			remove-attribute: style;
		}
		console-log: "Remove MAIN size attribute";
	}


	/***
	 * Close the panel when the close button or the same row is clicked. Empty the aside panel.
	**/
	close-panel:click,
	app-panel:nth-of-type(3) panel-list list-item:if-var($currentUserID "{@data-id}"):click {
		empty: app-panel:nth-of-type(4) panel-list;
		console-log: "Empty panel-list to close panel";
	}
    </style>
  </head>

  <body style="opacity: 0.0; transition: opacity 1s ease-in-out;">
    <script>0</script>
    <app-container>
      <app-panel>
        <app-logo>D7460N</app-logo>
        <app-class></app-class>
        <app-user>First LastName</app-user>
      </app-panel>
      <app-panel>
        <panel-header>
          <panel-title>SECTION 01</panel-title>
          <panel-meta>[ 843 ]</panel-meta>
        </panel-header>
        <panel-list>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 1235 ]</list-cell>
          </list-item>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 12 ]</list-cell>
          </list-item>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 35 ]</list-cell>
          </list-item>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 5 ]</list-cell>
          </list-item>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 25 ]</list-cell>
          </list-item>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 984 ]</list-cell>
          </list-item>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 984 ]</list-cell>
          </list-item>
        </panel-list>
        <p>&#160;</p>
        <panel-header>
          <panel-title>SECTION 02</panel-title>
          <panel-meta>[ 843 ]</panel-meta>
        </panel-header>
        <panel-list>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 1235 ]</list-cell>
          </list-item>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 12 ]</list-cell>
          </list-item>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 35 ]</list-cell>
          </list-item>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 5 ]</list-cell>
          </list-item>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 25 ]</list-cell>
          </list-item>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 984 ]</list-cell>
          </list-item>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 984 ]</list-cell>
          </list-item>
        </panel-list>
        <p>&#160;</p>
        <panel-header>
          <panel-title>SECTION 03</panel-title>
          <panel-meta>[ 843 ]</panel-meta>
        </panel-header>
        <panel-list>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 1235 ]</list-cell>
          </list-item>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 12 ]</list-cell>
          </list-item>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 35 ]</list-cell>
          </list-item>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 5 ]</list-cell>
          </list-item>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 25 ]</list-cell>
          </list-item>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 984 ]</list-cell>
          </list-item>
          <list-item>
            <list-cell><input type="checkbox" /></list-cell>
            <list-cell>Nav Item</list-cell>
            <list-cell>[ 984 ]</list-cell>
          </list-item>
        </panel-list>
      </app-panel>

      <!-- <header>
        <h1>Header Title</h1>
        <small>Header Subtitle</small>
      </header> -->

      <app-panel>
        <panel-header>
          <panel-title>SEARCH RESULTS
            <app-count>
              [&#160;<span id="visibleCount"></span>/<span id="nonVisibleCount"></span>&#160;]
            </app-count>
          </panel-title>
          <list-item>
            <list-cell><a href="#">01</a></list-cell>
            <list-cell><a href="#">02</a></list-cell>
            <list-cell><a href="#">03</a></list-cell>
            <list-cell><a href="#">04</a></list-cell>
            <list-cell><a href="#">05</a></list-cell>
          </list-item>
        </panel-header>
        <list-item>
          <list-cell><input type="checkbox"></list-cell>
          <list-cell>ID</list-cell>
<!--          <list-cell>Name</list-cell>
          <list-cell>Username</list-cell>
          <list-cell>Website</list-cell>
          <list-cell>Email</list-cell>-->
          <list-cell>Alias</list-cell>
          <list-cell>Full name</list-cell>
          <list-cell>Alignment</list-cell>
          <list-cell>Group affiliation</list-cell>
          <list-cell>Power</list-cell>
        </list-item>
        <panel-list></panel-list>
        <br />
        <app-panel-scroll>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. </p>
        </app-panel-scroll>
        <panel-corner-top-left></panel-corner-top-left>
        <panel-corner-top-right></panel-corner-top-right>
        <panel-corner-bottom-left></panel-corner-bottom-left>
        <panel-corner-bottom-right></panel-corner-bottom-right>
      </app-panel>
      <app-panel>
        <panel-header>
          <panel-title>ASIDE</panel-title>
          <close-panel title="Close panel">[ x ]</close-panel>
        </panel-header>
        <panel-list></panel-list>
        <app-panel-scroll>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
        </app-panel-scroll>
        <panel-corner-top-left></panel-corner-top-left>
        <panel-corner-top-right></panel-corner-top-right>
        <panel-corner-bottom-left></panel-corner-bottom-left>
        <panel-corner-bottom-right></panel-corner-bottom-right>
      </app-panel>
      <app-panel>
        <panel-header>
          <panel-title>ASIDE 2</panel-title>
          <close-panel title="Close panel">[ x ]</close-panel>
        </panel-header>
        <small>Header Subtitle</small>
        <panel-list></panel-list>
        <app-panel-scroll>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
        </app-panel-scroll>
        <panel-corner-top-left></panel-corner-top-left>
        <panel-corner-top-right></panel-corner-top-right>
        <panel-corner-bottom-left></panel-corner-bottom-left>
        <panel-corner-bottom-right></panel-corner-bottom-right>
      </app-panel>
      <app-panel>
        <app-author>D7460N</app-author>
        <app-class></app-class>
        <app-version>v0.001</app-version>
      </app-panel>
    </app-container>

    <script type="text/javascript" charset="utf-8" src="assets/js/activecss-core-dev-2-11-0.js"></script>
    <script type="text/javascript" charset="utf-8" src="assets/js/scripts.js"></script>
    <noscript><style>body {opacity: 1.0;}</style></noscript>
  </body>

</html>
